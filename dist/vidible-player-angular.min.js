!function(e){"use strict";var i=e.module("ngLoadScript",[]);i.directive("script",function(){return{restrict:"E",scope:!1,link:function(e,i,t){if("text/javascript-lazy"===t.type){var n=document.createElement("script");n.type="text/javascript";var r=i.attr("src");if(void 0!==r)n.src=r;else{var a=i.text();n.text=a}document.head.appendChild(n),i.remove()}}}})}(angular),function(e){"use strict";e.module("vidible-module",[]).service("vidibleQueueLoader",["$http","$timeout",function(i,t){function n(e,t,n){var r="http://delivery.vidible.tv/jsonp/pid="+t+"/vid="+e+"/"+s+".js";i.get(r).then(function(e){n(e.status,"<script>"+e.data+"</script>")},function(e){n(e.status,null)})}function r(e,i,n){if(p||(p=(new Date).getTime()),e.vdb_Player)i(e.vdb_Player),p=null;else{var a=(new Date).getTime(),u=a-p;if(u>=n)return console.error("Timeout while waiting to vidible script to load..."),console.log(e),void(p=null);t(function(){r(e,i,n)},0)}}function a(e){return e?c:v}function u(){if(l.length>0){var i=l.shift(),t=angular.element('<div class="player vdb_player"></div>');n(i.vidOptions.videoId,a(i.vidOptions.autoplay),function(n,o){if(200==n){var l=e.element(t);l.addClass("vdb_"+a(i.vidOptions.autoplay)+s),t.append(o),i.elem.append(t),r(t[0],function(e){i.cb(e),u()},d)}else console.error("Error loading vidable with id = "+i.vid),u()})}}var o={},d=5e3,l=[],c="55c8aae9e4b0ca68372fb553",v="55e6e684e4b061356c07ceb6",s="55af9dcae4b02944c03a2eee",p=null;return o.queueForProcessing=function(e,i,t,n){l.push({vidOptions:{videoId:e,autoplay:i},elem:t,cb:n}),l.length>1||u()},o}]).directive("vidiblePlayer",["$timeout","$interval","vidibleQueueLoader",function(e,i,t){function n(e){switch(e){case vidible.PLAYER_READY:return a+"ready";case vidible.VIDEO_END:return a+"ended";case vidible.VIDEO_PAUSE:return a+"paused";case vidible.VIDEO_PLAY:return a+"playing";case vidible.VIDEO_DATA_LOADED:return a+"loaded";case vidible.VIDEO_TIMEUPDATE:return a+"timeUpdate"}}var r=1,a="vidible.player.";return{restrict:"EA",scope:{videoId:"=videoId",player:"=?",playerId:"@playerId",autoplay:"=?autoplay"},link:function(e,u,o){function d(){var i=Array.prototype.slice.call(arguments);e.$emit.apply(e,i)}function l(e,i){[vidible.PLAYER_READY,vidible.VIDEO_DATA_LOADED,vidible.VIDEO_PLAY,vidible.VIDEO_PAUSE,vidible.VIDEO_END,vidible.VIDEO_TIMEUPDATE].forEach(function(e){i.addEventListener(e,function(t){d(n(e),i,t)})})}function c(){e.player&&e.player.getVidiblePlayer()&&e.player.getVidiblePlayer().destroy(),u.empty()}function v(e){var t=e.isMuted();return i(function(){var i=e.isMuted();if(void 0!=i){if(void 0!==t&&t!==i){var n=a+(i?"muted":"unmuted");d(n,e,{muted:i})}t=i}},0)}function s(t){var n={getVidiblePlayer:function(){return t},pause:function(){t.pause()},play:function(){t.play()},replay:function(){e.autoplay=!0,p(e.videoId)},mute:function(){t.mute()},unmute:function(){e.player.isMuted()&&t.mute()},getVolume:function(){return t.getPlayerInfo().volume},isMuted:function(){var e=t.getPlayerInfo().volume;return void 0===e||null==e?void 0:0===t.getPlayerInfo().volume}};e.player=n,l(n,t);var r=v(n);n.destroy=function(){i.cancel(r),c()}}function p(i){c(),t.queueForProcessing(i,e.autoplay,u,s)}var f=u[0].id||o.playerId||"page-unique-vidible-id-"+r++;u[0].id=f;var y=e.$watch(function(){return"undefined"!=typeof e.videoId},function(i){i&&(y(),e.$watch("videoId",function(){p(e.videoId)}))});e.$on("$destroy",function(){c()})}}}])}(angular);